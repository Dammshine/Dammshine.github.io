<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>BFS | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Algorithm of BFS searchGiven a graph G(V, E), the edges of given vertice v, is adj[v]. 1234567891011121314151617181920212223242526272829303132333435&#x2F;&#x2F; This algorithm construct a BFS tree&#x2F;&#x2F; Color repre">
<meta property="og:type" content="article">
<meta property="og:title" content="BFS">
<meta property="og:url" content="http://example.com/2022/04/28/BFS/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Algorithm of BFS searchGiven a graph G(V, E), the edges of given vertice v, is adj[v]. 1234567891011121314151617181920212223242526272829303132333435&#x2F;&#x2F; This algorithm construct a BFS tree&#x2F;&#x2F; Color repre">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-04-28T03:40:35.000Z">
<meta property="article:modified_time" content="2022-04-28T03:56:46.680Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Algorithm">
<meta property="article:tag" content="Graph">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-BFS" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/04/28/BFS/" class="article-date">
  <time class="dt-published" datetime="2022-04-28T03:40:35.000Z" itemprop="datePublished">2022-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/COMP2521/">COMP2521</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      BFS
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Algorithm-of-BFS-search"><a href="#Algorithm-of-BFS-search" class="headerlink" title="Algorithm of BFS search"></a>Algorithm of BFS search</h2><p>Given a graph G(V, E), the edges of given vertice v, is adj[v].</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// This algorithm construct a BFS tree</span><br><span class="line">// Color represented</span><br><span class="line">//  1. Wite, undiscovered</span><br><span class="line">//  2. Gret, discovered but uninspected</span><br><span class="line">//  3. Black, discovered and inspected</span><br><span class="line">// u.d store the distance from s to u</span><br><span class="line">// u.pi store the parent of u : defined as the node discovered u</span><br><span class="line">BFS(G, s)</span><br><span class="line">    // Initialize all node to white (undiscovered)</span><br><span class="line">    <span class="keyword">for</span> each vertex u belong G.V - &#123; s &#125;</span><br><span class="line">        u.color = white</span><br><span class="line">        u.d = infinity</span><br><span class="line">        u.pi = NIL</span><br><span class="line">    </span><br><span class="line">    // Discovered s</span><br><span class="line">    s.color = gret</span><br><span class="line">    s.d = 0</span><br><span class="line">    s.pi = NIL</span><br><span class="line"></span><br><span class="line">    // Create queue (include as discover process)</span><br><span class="line">    Q = empty</span><br><span class="line">    enqueue(Q, s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> Q != empty </span><br><span class="line">        // Inspect front element</span><br><span class="line">        u = dequeue(Q)</span><br><span class="line">        <span class="keyword">for</span> each v belong to G.Adj[u]</span><br><span class="line">            // Disover the undiscovered vertice that are adjacent to u</span><br><span class="line">            <span class="keyword">if</span> v.color == white</span><br><span class="line">                v.color = grey</span><br><span class="line">                v.d = u.d + 1</span><br><span class="line">                v.pi = u </span><br><span class="line">                enqueue(v)</span><br><span class="line">        // Finish inspect u</span><br><span class="line">        u.color = black</span><br></pre></td></tr></table></figure>

<h4 id="Discussion-of-shortest-path"><a href="#Discussion-of-shortest-path" class="headerlink" title="Discussion of shortest path"></a>Discussion of shortest path</h4><p>Define shortest path as shortest path &lt;&#x3D; all exist path.</p>
<p>Lemma 22.1 Let G &#x3D; (V,E) be a directed or undirrected graph, let s belong to v be an arbitary vertex. Then for any edge(u,v) belong to E<br>            Shortest distance(s, v) &lt;&#x3D; Shortest distance(s, u) + 1.   (1)</p>
<p>Proof:<br>    Suppose v is reachtable from S, then there are total two cases<br>        1. There exist shorter path from s to u, else than through v. Then choose this path. (1) hold.<br>        2. There do not exist shorter path, or path else than through v. Choose path to v, and edge(v,u). (1) hold</p>
<p>Lemma 22.2 Let G &#x3D; (V,E) be a directed or undirrected graph, and suppose BFS is run on G from a given source vertex s belong V. Then upon termination,<br>            each vertice, v.d &gt;&#x3D; shortest path(s, v)</p>
<p>At first, v.d do not necessarly represent distance, so one can not chaim it have to be smaller than path, at least require explaniation.<br>From the algorithm, each vertice must have a parent node, denote u, and v.d &#x3D; u.d + 1. Then, by trace parent vertice of each vertice, we can<br>draw a path from v to s, by property that each vertice must have a parent vertice. </p>
<p>This path is greater or equal to the shortest path.</p>
<p>Lemma 22.3 Suppose during the execution of BFS, the queue Q contain following vertex<br>            {v1, v2,…vr}, where v1 is the head of Q and vr is the tail<br>            Then, vr.d &lt;&#x3D; v1.d + 1 and vi.d &lt; vi+1.d.</p>
<pre><code>Proof by induction.
At begining of BFS, there is only s in queue. Hence statement is true.
Assuming the above holds, by dequeue v1, v2 become head. 
vi.d &lt; vi+1.d unaffected for now.
vr.d &lt;= v1.d + 1 &lt; = v2.d + 1. Hence it also hold.

Now consider 2 cases
    1. No adjacent vertex added, then the above obviously hold.
    2. Adjacent vertex u, added to the list.
        u.d = v1.d + 1. And vr.d &lt;= v1.d + 1 &lt;= u.d. Thus vi.d &lt; vi+1.d hold.
        u.d = v1.d + 1 &lt;= v2.d + 1. Thus vr.d &lt; vi+1.d hold
</code></pre>
<p>Collorary 22.4<br>If vi enqueue early than vj, the v1.d &lt;&#x3D; vj.d.</p>
<p>Theorem 22.5<br>BFS search always produce shortest path.<br>During the BFS search, from s, for every other node blong G(V, E) have property<br>    v.d &#x3D; shortest path(s, v)</p>
<p>Prove by contradiction. Suppose there exist a node v such that<br>    v.d !&#x3D; shortest path(s, v).</p>
<p>By lemma 22.1, we know v.d &gt;&#x3D; shortest path(s, v), then we can deduce v.d &gt; shortrest path(s,v).<br>Vertex v have to be reachtable, else both infinity.<br>Because it is reachtable, consider the parent node of v, denote u that have preceding shortest path, discussed in lemma 22.2<br>we have shortest path(s,v) &#x3D; shortest path(s, u) + 1,<br>Then we have<br>v.d &gt; sd(s,v) &#x3D; sd(s, u) + 1 &#x3D; u.d + 1. </p>
<p>Then, consider the v’s color when u have being dequeue.<br>It either be white (undiscovered)<br>    then we know v.d &#x3D; u.d + 1. Contradiction.<br>If v is black,<br>    then it enqueue before u, v.d &lt;&#x3D; u.d. Contradiction, discussed above, in order to contradict the theorem, v.d &gt; sd(s, d), thus also greater than u.d + 1.<br>If v is gray,<br>    then it painted before dequeue u, painted by the vertex  denoted by w. And w is enqueue before u, so w.d &lt;&#x3D; u.d, and v.d &#x3D; w.d + 1 &lt;&#x3D; u.d + 1.<br>    Again by analysis, it have to be greater than u.d + 1. Hence contradiction&#x2F;</p>
<p>Thus, we conclude for all vertice v, after BFS(s, v), v.d is the sd(s, v). And we can obatin a shortest path from s to v.parent, and by repeat this process.</p>
<h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><p>Enqueue, dequeue takes O(1), so the time devoted for dequeueing and enququeing takes O(V). Because BFS require scan each vertex at most one time, then for adjency list it would be O(E) and adjency matrix would be O(V^2). So the total running time would be O(V + E) or O(V + V^2) depend on the implementation. For dense graph, it’s O(E) for both implementation, for dense graph adjency list will be slightly better. </p>
<h2 id="BFS-tree"><a href="#BFS-tree" class="headerlink" title="BFS tree"></a>BFS tree</h2><p>Assume original graph G(V, E)<br>then by BFS search, we will get<br>    G(Gpi, Epi).<br>    where Vp &#x3D; {v : v.pi !&#x3D; Nil} &amp;&amp; {s} &#x2F;&#x2F; This will eliminate node not reachtable<br>    Epi {v.pi, v: v belong vp}          &#x2F;&#x2F; Include all edges that are linked</p>
<p>Gpi is a BFT, the shortest path in this curve from s to any v will also be shortest path from s to v.<br>And abs(E) &#x3D; abs(V) - 1, this is preserved from tree property. </p>
<p>Lemma BFS result a BFT. (No comments needed for this one)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/04/28/BFS/" data-id="cl2ih4atr0000w4trhvkqhp1c" data-title="BFS" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Graph/" rel="tag">Graph</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/04/28/DFS/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          DFS
        
      </div>
    </a>
  
  
    <a href="/2022/04/28/Tries-Radix-tree/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Tries (Radix tree)</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/COMP2521/">COMP2521</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ADT/" rel="tag">ADT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/COMP2521/" rel="tag">COMP2521</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Structure/" rel="tag">Data Structure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Graph/" rel="tag">Graph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Language/" rel="tag">Language</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Personal/" rel="tag">Personal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Programming-Paradigm/" rel="tag">Programming Paradigm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Report/" rel="tag">Report</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sorting/" rel="tag">Sorting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Theory/" rel="tag">Theory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tree/" rel="tag">Tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ADT/" style="font-size: 12.5px;">ADT</a> <a href="/tags/Algorithm/" style="font-size: 20px;">Algorithm</a> <a href="/tags/COMP2521/" style="font-size: 15px;">COMP2521</a> <a href="/tags/Data-Structure/" style="font-size: 20px;">Data Structure</a> <a href="/tags/Graph/" style="font-size: 15px;">Graph</a> <a href="/tags/Language/" style="font-size: 10px;">Language</a> <a href="/tags/Personal/" style="font-size: 10px;">Personal</a> <a href="/tags/Programming-Paradigm/" style="font-size: 10px;">Programming Paradigm</a> <a href="/tags/Report/" style="font-size: 10px;">Report</a> <a href="/tags/Sorting/" style="font-size: 10px;">Sorting</a> <a href="/tags/Theory/" style="font-size: 15px;">Theory</a> <a href="/tags/Tree/" style="font-size: 17.5px;">Tree</a> <a href="/tags/git/" style="font-size: 10px;">git</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/05/13/git/">git</a>
          </li>
        
          <li>
            <a href="/2022/05/06/NodesNotInCycle/">NodesNotInCycle</a>
          </li>
        
          <li>
            <a href="/2022/05/04/Things-I-know-so-far/">Things I know so far</a>
          </li>
        
          <li>
            <a href="/2022/05/03/Hash-Table/">Hash Table</a>
          </li>
        
          <li>
            <a href="/2022/05/03/Dynamic-Programming/">Dynamic Programming</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>